<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Variable Font Example</title>
  <style>
    @font-face {
      font-family: 'TYPETR-Bitcount-VF';
      src: url('fonts/ttf/variable/BitcountInk[CRSV,ELSH,ELXP,SZP1,SZP2,XPN1,XPN2,YPN1,YPN2,slnt,wght].ttf') format('truetype');
      /* Add other font properties if needed */
    }
    #text-container {
      width: 80%;
      margin: 50px auto;
    }
    #sample-text {
      font-family: 'TYPETR-Bitcount-VF', sans-serif;
      font-size: 300px;
    }
    .slider-container {
      margin-bottom: 0px;
    }
    .slider-container label {
      display: block;
    }
  </style>
</head>
<body>

<div id="text-container">
  <div id="sample-text"><span style="font-size: 500px;">/canvasa</span><br/>Bitcount-VF</div>

  <div>
    <button id="randomButton">Randomize</button>
    <button id="randomPixelShapeButton">Randomize Pixel Shape</button>
    <button id="randomForegroundButton">Randomize Color Foreground</button>
    <button id="randomBackgroundButton">Randomize Color Background</button>
  </div>

  <div class="slider-container">
    <label for="size-slider">Font Size</label>
    <input type="range" min="10" max="300" value="180" class="slider" id="size-slider">
  </div>

  <div class="slider-container">
    <label for="weight-slider">Font Weight [wght]</label>
    <input type="range" min="100" max="900" value="400" class="slider" id="weight-slider">
  </div>

  <div class="slider-container">
    <label for="ELXP-slider">Pixel Open - Element expansion [ELXP]</label>
    <input type="checkbox" id="fixELXP" value="1" checked/>
    <input type="range" min="0" max="100" value="0" class="slider" id="ELXP-slider">
  </div>

  <div class="slider-container">
    <label for="ELSH-slider">Element Shape [ELSH]</label>
    <input type="checkbox" id="fixELSH" value="1" checked/>
    <input type="range" min="0" max="100" value="0" class="slider" id="ELSH-slider">
  </div>

  <div class="slider-container">
    <label for="slant-slider">Slant [slnt]</label>
    <input type="range" min="0" max="100" value="1" class="slider" id="slant-slider">
  </div>

  <div class="slider-container">
    <label for="slant-slider">Cursive [CRSV]</label>
    <input type="range" min="0" max="1" value="0" class="slider" id="CRSV-slider">
  </div>

  <h2>COLRv1 axes</h2>

  <div class="slider-container">
    <label for="SZP2-slider">Foreground Size - Size of Paint 2 [SZP2]</label>
    <input type="checkbox" id="fixSZP2" value="1" checked/>
    <input type="range" min="0" max="100" value="30" class="slider" id="SZP2-slider">
  </div>

  <div class="slider-container">
    <label for="XPN2-slider">Foreground X [XPN2]</label>
    <input type="checkbox" id="fixXPN2" value="1" checked/>
    <input type="range" min="0" max="100" value="50" class="slider" id="XPN2-slider">
  </div>

  <div class="slider-container">
    <label for="YPN2-slider">Foreground Y [YPN2]</label>
    <input type="checkbox" id="fixYPN2" value="1" checked/>
    <input type="range" min="0" max="100" value="50" class="slider" id="YPN2-slider">
  </div>

  <div class="slider-container">
    <label for="SZP1-slider">Background Size - Size of Paint 1 [SZP1]</label>
    <input type="checkbox" id="fixSZP1" value="1" checked/>
    <input type="range" min="0" max="100" value="30" class="slider" id="SZP1-slider">
  </div>

  <div class="slider-container">
    <label for="XPN1-slider">Background X [XPN1]</label>
    <input type="checkbox" id="fixXPN1" value="1" checked/>
    <input type="range" min="0" max="100" value="50" class="slider" id="XPN1-slider">
  </div>

  <div class="slider-container">
    <label for="YPN1-slider">Background Y [YPN1]</label>
    <input type="checkbox" id="fixYPN1" value="1" checked/>
    <input type="range" min="0" max="100" value="50" class="slider" id="YPN1-slider">
  </div>


  </div>


<script>
    // Check if the browser is Chrome
    var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);

    // Function to update the sample text style
    function updateTextStyle() {
      const weight = document.getElementById('weight-slider').value;
      const elementOpen = document.getElementById('ELXP-slider').value;
      const elementShape = document.getElementById('ELSH-slider').value;
      const slant = document.getElementById('slant-slider').value;
      const size = document.getElementById('size-slider').value;
      // COLRv1 
      const fgSize = document.getElementById('SZP2-slider').value;
      const fgX = document.getElementById('XPN2-slider').value;
      const fgY = document.getElementById('YPN2-slider').value;
      const bgSize = document.getElementById('SZP1-slider').value;
      const bgX = document.getElementById('XPN1-slider').value;
      const bgY = document.getElementById('YPN1-slider').value;

      const sampleText = document.getElementById('sample-text');
      sampleText.style.fontVariationSettings = `'wght' ${weight}, 'ELXP' ${elementOpen}, 'ELSH' ${elementShape}, 'slnt' ${slant},
        'SZP1' ${bgSize}, 'XPN1' ${bgX}, 'YPN1' ${bgY}, 
        'SZP2' ${fgSize}, 'XPN2' ${fgX}, 'YPN2' ${fgY}`;
      sampleText.style.fontSize = `${size}px`;
    }

  // Event listeners for sliders
  const sliders = document.querySelectorAll('.slider');
  sliders.forEach(slider => {
    slider.addEventListener('input', updateTextStyle);
  });

  // Initial call to set the sample text style
  updateTextStyle();

    if (isChrome) {
      document.write("<p>This page is running on Chrome browser.</p>");
    } else {
      document.write("<p>This page is not running on Chrome browser.</p>");
    }

  // Get the sample text element
  const sampleText = document.getElementById('sample-text');

  angleELSH = 0; // Shaping the pixel
  angleELXP = 0; // Open pixel in quadrants

  angleSZP1 = 0;
  angleXPN1 = 0;
  angleYPN1 = 0;
  angleSZP2 = 0;
  angleXPN2 = 0;
  angleYPN2 = 0;

  const stepELSH = 4; // Increment of the cycle angles
  const stepELXP = 2;
  const stepSZP1 = 2.2;
  const stepXPN1 = 3.2;
  const stepYPN1 = 3;
  const stepSZP2 = 2.1;
  const stepXPN2 = 4.2;
  const stepYPN2 = 4;

  stepFactor = 0.5 // Overall speed factor for steps

  const minELSH = 0;
  const minELXP = 0;
  const minSZP1 = 10;
  const minXPN1 = 25;
  const minYPN1 = 25;
  const minSZP2 = 10;
  const minXPN2 = 0;
  const minYPN2 = 0;

  const maxELSH = 100;
  const maxELXP = 80; // Not too open in this animation
  const maxSZP1 = 90;
  const maxXPN1 = 80;
  const maxYPN1 = 80;
  const maxSZP2 = 60;
  const maxXPN2 = 80;
  const maxYPN2 = 80;

  function normalizeAngle(angle) {
      return (angle % 360 + 360) % 360;
  }

  function updateValues() {
    if (document.getElementById('fixELSH').checked) {
      valELSH = (Math.sin((angleELSH * Math.PI/180))/2 + 0.5) * (maxELSH - minELSH) + minELSH;
      document.getElementById('ELSH-slider').value = valELSH;
    }
    valELXP = (Math.sin((angleELXP * Math.PI/180))/2 + 0.5) * (maxELXP - minELXP) + minELXP;
    document.getElementById('ELXP-slider').value = valELXP;

    valSZP1 = (Math.sin((angleSZP1 * Math.PI/180))/2 + 0.5) * (maxSZP1 - minSZP1) + minSZP1;
    document.getElementById('SZP1-slider').value = valSZP1;

    valXPN1 = (Math.sin((angleXPN1 * Math.PI/180))/2 + 0.5) * (maxXPN1 - minXPN1) + minXPN1;
    document.getElementById('XPN1-slider').value = valXPN1;

    valYPN1 = (Math.sin((angleYPN1 * Math.PI/180))/2 + 0.5) * (maxYPN1 - minYPN1) + minYPN1;
    document.getElementById('YPN1-slider').value = valYPN1;

    valSZP2 = (Math.sin((angleSZP2 * Math.PI/180))/2 + 0.5) * (maxSZP2 - minSZP2) + minSZP2;
    document.getElementById('SZP2-slider').value = valSZP2;

    valXPN2 = (Math.sin((angleXPN2 * Math.PI/180))/2 + 0.5) * (maxXPN2 - minXPN2) + minXPN2;
    document.getElementById('XPN2-slider').value = valXPN2;

    valYPN2 = (Math.sin((angleYPN2 * Math.PI/180))/2 + 0.5) * (maxYPN2 - minYPN2) + minYPN2;
    document.getElementById('YPN2-slider').value = valYPN2;

  }
  // Function to animate through all axes smoothly
  function animateVariableFont() {
    updateValues();

    if (document.getElementById('fixELSH').checked)
      angleELSH = normalizeAngle(angleELSH + stepELSH * stepFactor);
    angleELXP = normalizeAngle(angleELXP + stepELXP * stepFactor);
    angleSZP1 = normalizeAngle(angleSZP1 + stepSZP1 * stepFactor);
    angleXPN1 = normalizeAngle(angleXPN1 + stepXPN1 * stepFactor);
    angleYPN1 = normalizeAngle(angleYPN1 + stepYPN1 * stepFactor);
    angleSZP2 = normalizeAngle(angleSZP2 + stepSZP2 * stepFactor);
    angleXPN2 = normalizeAngle(angleXPN2 + stepXPN2 * stepFactor);
    angleYPN2 = normalizeAngle(angleYPN2 + stepYPN2 * stepFactor);

    updateTextStyle();
    //sampleText.style.fontVariationSettings = "'SZP1' ${valSZP1}, 'XPN1' ${valXPN1}, 'XPN1' ${valXPN1}, 'SZP2' ${valSZP2}, 'XPN2' ${valXPN2}, 'XPN2' ${valXPN2}, ";

  }

  // Periodically call the function
  setInterval(animateVariableFont, 100); 
  
  function handleClick() {
    alert("Button clicked!");
    // Add your JavaScript code here
  }

  function setRandomValue(slider) {

    // Generate a random value between min and max
    var randomValue = Math.floor(Math.random() * (parseFloat(slider.max) - parseFloat(slider.min) + 1)) + parseFloat(slider.min);

    // Set the slider value to the random value
    slider.value = randomValue;
  }

  function randomize() {
    randomizeShape();
    randomizeForegroundColor();
    randomizeBackgroundColor();
  }
  function randomizeShape() {
    // Set the animation angles to random values, instead of the sliders. 
    // They get updated anyway.
    angleELSH = Math.floor(Math.random() * (maxELSH - minELSH) + minELSH);
    updateValues();
  }
  // COLRv1
  function randomizeBackgroundColor() {
    angleSZP1 = Math.floor(Math.random() * (maxSZP1 - minSZP1) + minSZP1);
    angleXPN1 = Math.floor(Math.random() * (maxXPN1 - minXPN1) + minXPN1);
    angleYPN1 = Math.floor(Math.random() * (maxYPN1 - minYPN1) + minYPN1);
    updateValues();
  }
  function randomizeForegroundColor() {
    angleSZP2 = Math.floor(Math.random() * (maxSZP2 - minSZP2) + minSZP2);
    angleXPN2 = Math.floor(Math.random() * (maxXPN2 - minXPN2) + minXPN2);
    angleYPN2 = Math.floor(Math.random() * (maxYPN2 - minYPN2) + minYPN2);
    updateValues();
  }

  // Get the button element
  const randomButton = document.getElementById('randomButton');
  const randomPixelShapeButton = document.getElementById('randomPixelShapeButton');
  const randomForegroundButton = document.getElementById('randomForegroundButton');
  const randomBackgroundButton = document.getElementById('randomBackgroundButton');

  // Add a click event listener to the button, which calls the handleClick function when clicked
  randomButton.addEventListener('click', randomize);
  randomPixelShapeButton.addEventListener('click', randomizeShape);
  randomForegroundButton.addEventListener('click', randomizeForegroundColor);
  randomBackgroundButton.addEventListener('click', randomizeBackgroundColor);

  </script>

</body>
</html>
